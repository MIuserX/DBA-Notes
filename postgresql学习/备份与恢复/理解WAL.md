## 资料

官方文档：

Chapter 30：https://www.postgresql.org/docs/11/wal.html



## 带着问题去读

* 为什么 WAL 可以将数据库带到一致性状态？
* 理解 MySQL 的 binlog
* 文件系统中的日志记录
* WAL 文件相关
  * 查看当前保存的最老的 WAL 文件
  * 查看当前正在写的 WAL 文件



## 解决

* 数据存储在非易失性区域
  * power loss
  * OS failure
  * Hardware Failure(不包括非易失性存储区域自己)

成功地将数据写到磁盘上，就满足了上述条件。



* 操作系统对磁盘的缓存
* 磁盘本身的缓存

​		这两点影响了写磁盘操作，导致我们可能收到了 “写成功” 的信号，但实际上可能因为缓存没有实际写入磁盘而导致数据丢失。

​		幸运的是，这两个问题大部分情况下也可以被排除。



#### 为什么 WAL 能将数据库带到一致性状态？

理解这个问题的本质，在于理解 WAL 里存储了什么。



#### 数据库到底保留多少 WAL？

