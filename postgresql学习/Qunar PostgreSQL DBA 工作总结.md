[TOC]



# 关于文档

* 总结Qunar的 DBA 工作



# 都干了啥？

先头脑风暴一下：

* **部署新 DB Cluster**

  * 一主(两|三)从的 Cluster
  * 单点 Cluster

* **过保迁移**

  我理解本质上就是一个复制过程，唯一改变的是个hostname或IP。

* **DB超户的日志审计**

* **SQL Review 与执行**

  也就是所谓的 pg-request

* **处理报警**

* **运维工具**

  * 维护 saltstack
    * 升级
    * 新增/删除 节点
    * 迁移

* **监控工具**

  * 维护 zabbix 和 nagios

* **特殊任务**

  * 敏感词查找

* **咨询服务**

  * DB主从地址咨询
  * SQL编写咨询









### SQL Review

这是日常工作中占比最大几项工作之一。

细分的话，包括：

* 对 DEV 发的 SQL 进行 Review
* 



### 从业务的角度描述

* 部署新 DB Cluster
  * 部署线上新集群
  * 为线上集群部署一套新beta/dev集群



# 收获的一些经验

##### 1. DBA的东西统一管理

**过保迁移**这个工作在理论上就有缺陷，因为无法确定是否有没有照顾到的地方。

所以，开始就该构建一套完整的制度来指导这一切。

有历史包袱，也应该在日常工作不忙时，逐步解决历史包袱。

具体的方法是：DB 相关的东西尽量集中在一个目录。

这样的话，迁移的时候，理论上要迁移的东西是可以讲清楚的，就是相关的目录，移走就行。

如果有漏的，那就是不合规范导致的。





